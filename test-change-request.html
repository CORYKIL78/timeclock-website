<!DOCTYPE html>
<html>
<head>
    <title>Test Change Request System</title>
</head>
<body>
    <h1>Test Change Request System</h1>
    <div>
        <h3>Submit Test Request</h3>
        <button onclick="submitTestRequest()">Submit Name Change Request</button>
        <br><br>
        <button onclick="checkApproval()">Check Approval Status</button>
        <br><br>
        <button onclick="viewRequests()">View All Requests</button>
    </div>
    
    <div id="results"></div>

    <script>
        const testDiscordId = "123456789012345678"; // Test Discord ID
        
        async function submitTestRequest() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Submitting test request...</p>';
            
            try {
                const response = await fetch('https://timeclock-backend.marcusray.workers.dev/api/change-request/submit', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        discordId: testDiscordId,
                        requestType: 'name',
                        currentValue: 'Old Name',
                        requestedValue: 'New Test Name',
                        reason: 'Testing the change request system',
                        staffName: 'Test User',
                        email: 'test@example.com',
                        department: 'Testing',
                        staffId: 'TEST001'
                    })
                });
                
                const result = await response.text();
                resultsDiv.innerHTML = `<h4>Submit Response:</h4><pre>${result}</pre>`;
            } catch (error) {
                resultsDiv.innerHTML = `<p>Error: ${error.message}</p>`;
            }
        }
        
        async function checkApproval() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Checking approval status...</p>';
            
            try {
                const response = await fetch('https://timeclock-backend.marcusray.workers.dev/api/change-request/check-approved', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        discordId: testDiscordId
                    })
                });
                
                const result = await response.text();
                resultsDiv.innerHTML = `<h4>Approval Check Response:</h4><pre>${result}</pre>`;
            } catch (error) {
                resultsDiv.innerHTML = `<p>Error: ${error.message}</p>`;
            }
        }
        
        async function viewRequests() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Fetching all requests...</p>';
            
            try {
                const response = await fetch('https://timeclock-backend.marcusray.workers.dev/api/debug/requests');
                const result = await response.text();
                resultsDiv.innerHTML = `<h4>All Requests:</h4><pre>${result}</pre>`;
            } catch (error) {
                resultsDiv.innerHTML = `<p>Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>