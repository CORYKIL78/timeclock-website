<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <title>Staff Portal</title>
    
    <!-- SENTINEL Security Meta Tags -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://timeclock-backend.marcusray.workers.dev https://timeclock-proxy.marcusray.workers.dev https://portal.cirkledevelopment.co.uk https://cdn.jsdelivr.net https://media.discordapp.net https://cdn.pixabay.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data: https: blob:; font-src 'self' data:; media-src 'self' https://cdn.pixabay.com; connect-src 'self' https://timeclock-backend.marcusray.workers.dev https://timeclock-proxy.marcusray.workers.dev https://discord.com https://cdn.jsdelivr.net https://api.clickup.com;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta name="robots" content="noindex, nofollow">
    
    <link rel="icon" href="data:,">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="style.css?v=2.0.1">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Cache busting meta tag -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <!-- EMERGENCY MAINTENANCE CHECK -->
    <script>
        (async function() {
            try {
                const response = await fetch('https://timeclock-backend.marcusray.workers.dev/api/status');
                const data = await response.json();
                if (data.offline) {
                    window.location.href = '/maintenance.html';
                }
            } catch (e) {
                window.location.href = '/maintenance.html';
            }
        })();
    </script>
</head>
<body>
    <!-- Sidebar (desktop) / Topbar (mobile) -->
    <div id="sidebar" class="sidebar hidden">
        <div class="sidebar-header">
            <img id="sidebarProfilePic" class="profile-img" src="" alt="Profile">
        </div>
        <button class="sidebar-toggle">‚ò∞</button>
        <div id="sidebarNav">
            <button id="homeBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg> Home</button>
            <button id="myRolesBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg> My Roles</button>
            <button id="absencesBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg> Absences</button>
            <button id="payslipsBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg> Payslips</button>
            <button id="disciplinariesBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg> Disciplinaries</button>
            <button id="requestsBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg> Requests</button>
            <button id="timeclockBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> Timeclock</button>
            <button id="mailBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg> Mail</button>
            <button id="calendarBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg> Calendar</button>
            <button id="clickupBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg> ClickUp</button>
            <button id="handbooksBtn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> Handbooks</button>
        </div>
        <div class="sidebar-footer">
            <button id="logoutBtn" class="action-btn logout-btn" title="Log Out">
                <span class="logout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg></span>
                <span>Log Out</span>
            </button>
        </div>
    </div>

    <!-- Notification Button (Bottom Left Circle) -->
    <button id="notificationBtn" class="notification-btn" aria-label="Notifications">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
        <span id="notificationBadge" class="notification-badge hidden">0</span>
    </button>

    <!-- Notifications Panel -->
    <div id="notificationPanel" class="notifications-panel hidden">
        <div class="notifications-header">
            <h3>Notifications</h3>
            <button id="clearAllNotifications" class="clear-all-notifications-btn">Clear All</button>
            <button id="closeNotifications" class="close-notifications-btn">&times;</button>
        </div>
        <ul id="notificationList"></ul>
    </div>

    <!-- Modals -->
    <div id="alertModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="alertMessage"></div>
        </div>
    </div>
    <div id="composeMailModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="mail-compose">
                <h2>Compose Mail</h2>
                <select id="mailRecipients" multiple required>
                    <option value="" disabled>Select Recipients</option>
                </select>
                <input type="text" id="mailSubject" placeholder="Subject">
                <textarea id="mailContent" placeholder="Message"></textarea>
                <input type="file" id="mailAttachments" multiple>
                <div id="mailError" class="mail-error hidden">Select at least one participant</div>
                <div class="mail-actions">
                    <button id="sendMailBtn">Send</button>
                    <button id="saveDraftBtn">Save to Drafts</button>
                </div>
            </div>
        </div>
    </div>
    <div id="resetProfileModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Reset Profile</h2>
            <p>Are you sure you want to reset your profile? This cannot be undone.</p>
            <button id="confirmResetBtn">Confirm</button>
        </div>
    </div>
    <div id="absenceRequestModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Request Absence</h2>
            <select id="absenceType">
                <option value="Illness">Illness</option>
                <option value="Vacation">Vacation</option>
                <option value="Personal">Personal</option>
                <option value="Education">Education</option>
                <option value="No Device/Wifi">No Device/Wifi</option>
                <option value="Other">Other (specify in comment)</option>
            </select>
            <input type="date" id="absenceStartDate">
            <input type="date" id="absenceEndDate">
            <textarea id="absenceComment" placeholder="Comment"></textarea>
            <p id="absenceDays">Total Days: 0</p>
            <button id="submitAbsenceBtn">Submit</button>
        </div>
    </div>
    <div id="deptChangeModal" class="modal">
        <div class="modal-content request-modal">
            <span class="close">&times;</span>
            <h2>Request Department Change</h2>
            <div class="request-field">
                <label for="deptSelect">New Department:</label>
                <select id="deptSelect">
                    <option value="Customer Relations Department">Customer Relations</option>
                    <option value="Development Department">Development</option>
                    <option value="Finance Department">Finance</option>
                </select>
            </div>
            <div class="request-field">
                <label for="deptChangeReason">Reason:</label>
                <textarea id="deptChangeReason" placeholder="Please explain why you need to change departments"></textarea>
            </div>
            <div class="request-buttons">
                <button id="deptRequestBtn" class="submit-request-btn">Submit Request</button>
                <button id="deptCancelBtn" class="cancel-request-btn">Cancel</button>
            </div>
            <div id="deptChangeSuccess" class="request-success hidden">Request submitted successfully!</div>
        </div>
    </div>
    <div id="viewMailModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="viewMailContent"></div>
            <button id="replyMailBtn" class="hidden">Reply</button>
        </div>
    </div>
    <div id="replyMailModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Reply to Mail</h2>
            <textarea id="replyContent" placeholder="Your reply..."></textarea>
            <button id="sendReplyBtn">Send</button>
        </div>
    </div>
    <div id="absenceDetailModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Absence Details</h2>
            <div id="absenceDetailContent" class="absence-details">
                <p><strong>Type:</strong> <span id="absenceDetailType"></span></p>
                <p><strong>Start Date:</strong> <span id="absenceDetailStartDate"></span></p>
                <p><strong>End Date:</strong> <span id="absenceDetailEndDate"></span></p>
                <p><strong>Total Days:</strong> <span id="absenceDetailDays"></span></p>
                <p><strong>Reason:</strong> <span id="absenceDetailReason"></span></p>
                <p><strong>Comment:</strong> <span id="absenceDetailComment"></span></p>
            </div>
            <button id="cancelAbsenceBtn" class="cancel-absence-btn hidden">Cancel Absence</button>
            <button id="deleteAbsenceBtn" class="delete-absence-btn hidden">Delete Absence</button>
        </div>
    </div>
    <div id="confirmCancelAbsenceModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Confirm Absence Cancellation</h2>
            <p>Are you sure you want to cancel your absence?</p>
            <button id="confirmCancelAbsenceBtn" class="cancel-absence-btn">Cancel Absence</button>
            <button id="noCancelAbsenceBtn">No</button>
        </div>
    </div>
    <div id="payslipViewModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Payslip Details</h2>
            <div id="payslipViewContent">
                <p><strong>Date:</strong> <span id="payslipDate"></span></p>
                <p><strong>Link:</strong> <a id="payslipLink" href="#" target="_blank">View Payslip</a></p>
                <p><strong>Comment:</strong> <span id="payslipComment"></span></p>
                <p><strong>Assigned by:</strong> <span id="payslipAssignedBy"></span></p>
            </div>
        </div>
    </div>

    <!-- Name Change Request Modal -->
    <div id="nameChangeModal" class="modal">
        <div class="modal-content request-modal">
            <span class="close">&times;</span>
            <h2>Request Name Change</h2>
            <div class="request-field">
                <label for="newNameInput">New Name:</label>
                <input type="text" id="newNameInput" placeholder="Enter your new name">
            </div>
            <div class="request-field">
                <label for="nameChangeReason">Reason:</label>
                <textarea id="nameChangeReason" placeholder="Please explain why you need to change your name"></textarea>
            </div>
            <div class="request-buttons">
                <button id="submitNameChangeBtn" class="submit-request-btn">Submit Request</button>
                <button id="cancelNameChangeBtn" class="cancel-request-btn">Cancel</button>
            </div>
            <div id="nameChangeSuccess" class="request-success hidden">Request submitted successfully!</div>
        </div>
    </div>

    <!-- Email Change Request Modal -->
    <div id="emailChangeModal" class="modal">
        <div class="modal-content request-modal">
            <span class="close">&times;</span>
            <h2>Request Email Change</h2>
            <div class="request-field">
                <label for="newEmailInput">New Email:</label>
                <input type="email" id="newEmailInput" placeholder="Enter your new email">
            </div>
            <div class="request-field">
                <label for="emailChangeReason">Reason:</label>
                <textarea id="emailChangeReason" placeholder="Please explain why you need to change your email"></textarea>
            </div>
            <div class="request-buttons">
                <button id="submitEmailChangeBtn" class="submit-request-btn">Submit Request</button>
                <button id="cancelEmailChangeBtn" class="cancel-request-btn">Cancel</button>
            </div>
            <div id="emailChangeSuccess" class="request-success hidden">Request submitted successfully!</div>
        </div>
    </div>

    <!-- Submit Request Modal -->
    <div id="submitRequestModal" class="modal">
        <div class="modal-content request-modal">
            <span class="close">&times;</span>
            <h2>Submit Request</h2>
            <div class="request-field">
                <label for="requestTypeSelect">Request Type:</label>
                <select id="requestTypeSelect">
                    <option value="">Select a type...</option>
                    <option value="Resignation">Resignation</option>
                    <option value="Dispute">Dispute</option>
                    <option value="Payment">Payment</option>
                    <option value="Bug Report">Bug Report</option>
                    <option value="Suggestion">Suggestion</option>
                </select>
            </div>
            <div class="request-field">
                <label for="requestDetailsTextarea">Details:</label>
                <textarea id="requestDetailsTextarea" placeholder="Enter your request details..." rows="6"></textarea>
            </div>
            <div class="request-buttons">
                <button id="submitRequestFormBtn" class="submit-request-btn">Submit Request</button>
                <button id="cancelRequestFormBtn" class="cancel-request-btn">Cancel</button>
            </div>
            <div id="requestSubmitSuccess" class="request-success hidden">Request submitted successfully!</div>
        </div>
    </div>

    <!-- Screens -->
    <div id="discordScreen" class="screen">
        <div class="container">
            <svg width="120" height="120" viewBox="0 0 71 55" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: 20px;">
                <path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.440769 45.4204 0.525289C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.525289C25.5141 0.443589 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.038 50.6034 51.2554 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978ZM23.7259 37.3253C20.2276 37.3253 17.3451 34.1136 17.3451 30.1693C17.3451 26.225 20.1717 23.0133 23.7259 23.0133C27.308 23.0133 30.1626 26.2532 30.1066 30.1693C30.1066 34.1136 27.28 37.3253 23.7259 37.3253ZM47.3178 37.3253C43.8196 37.3253 40.9371 34.1136 40.9371 30.1693C40.9371 26.225 43.7636 23.0133 47.3178 23.0133C50.9 23.0133 53.7545 26.2532 53.6986 30.1693C53.6986 34.1136 50.9 37.3253 47.3178 37.3253Z" fill="#5865F2"/>
            </svg>
            <h1>Welcome, please log in using Discord</h1>
            <button id="discordLoginBtn">Login with Discord</button>
            
            <!-- SENTINEL Security Badge (Bottom Left Footer) -->
            <div style="position: fixed; bottom: 20px; left: 20px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 12px 20px; border-radius: 50px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 10px; backdrop-filter: blur(10px); border: 2px solid #667eea;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L3 6V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V6L12 2Z" stroke="#667eea" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#e6eeff"/>
                    <path d="M9 12L11 14L15 10" stroke="#667eea" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span style="font-weight: 600; color: #667eea; font-size: 14px;">Protected by SENTINEL</span>
            </div>
        </div>
    </div>
    <div id="searchingScreen" class="screen loading-screen">
        <div class="container black-bg">
            <h2>Searching...</h2>
            <div class="spinner"></div>
        </div>
    </div>
    <div id="rolesScreen" class="screen loading-screen">
        <div class="container black-bg">
            <h2>Checking Roles...</h2>
            <div class="spinner"></div>
        </div>
    </div>
    <div id="cherryScreen" class="screen loading-screen">
        <div class="container black-bg">
            <h2>Verifying...</h2>
            <div class="spinner"></div>
        </div>
    </div>
    <div id="confirmScreen" class="screen">
        <div class="container">
            <h2>Profile Found</h2>
            <p>Please select "Finalise" to continue.</p>
            <button id="continueBtn">Finalise</button>
        </div>
    </div>
    <div id="setupWelcomeScreen" class="screen">
        <div class="container">
            <h2>Welcome!</h2>
            <p>Please set up your profile to continue.</p>
            <button id="setupStartBtn">Start</button>
        </div>
    </div>
    <div id="setupEmailScreen" class="screen">
        <div class="container">
            <h2>Please add your email</h2>
            <input type="email" id="setupEmailInput" placeholder="Email">
            <button id="setupEmailContinueBtn">Continue</button>
        </div>
    </div>
    <div id="setupNameScreen" class="screen">
        <div class="container">
            <h2>Let's give you a proper identity</h2>
            <p>Please insert your first and last name (not your real one, the one you use in the server)</p>
            <input type="text" id="setupNameInput" placeholder="First Last">
            <button id="setupNameContinueBtn">Continue</button>
        </div>
    </div>
    <div id="setupPreferencesScreen" class="screen">
        <div class="container">
            <h2>Let's set up your preferences</h2>
            <div class="preference-group">
                <h3>Timezone</h3>
                <select id="setupTimezoneSelect">
                    <option value="UTC">UTC (Coordinated Universal Time)</option>
                    <option value="Europe/London">GMT/BST (London, Dublin)</option>
                    <option value="Europe/Paris">CET/CEST (Paris, Madrid, Rome)</option>
                    <option value="Europe/Berlin">CET/CEST (Berlin, Amsterdam, Brussels)</option>
                    <option value="Europe/Warsaw">CET/CEST (Warsaw, Prague)</option>
                    <option value="Europe/Athens">EET/EEST (Athens, Bucharest)</option>
                    <option value="Europe/Istanbul">TRT (Istanbul)</option>
                    <option value="Europe/Moscow">MSK (Moscow)</option>
                    <option value="America/New_York">EST/EDT (New York, Toronto)</option>
                    <option value="America/Chicago">CST/CDT (Chicago, Mexico City)</option>
                    <option value="America/Denver">MST/MDT (Denver, Phoenix)</option>
                    <option value="America/Los_Angeles">PST/PDT (Los Angeles, Vancouver)</option>
                    <option value="America/Anchorage">AKST/AKDT (Alaska)</option>
                    <option value="Pacific/Honolulu">HST (Hawaii)</option>
                    <option value="America/Sao_Paulo">BRT (S√£o Paulo, Rio)</option>
                    <option value="Asia/Dubai">GST (Dubai, Abu Dhabi)</option>
                    <option value="Asia/Kolkata">IST (India)</option>
                    <option value="Asia/Shanghai">CST (Beijing, Shanghai)</option>
                    <option value="Asia/Tokyo">JST (Tokyo)</option>
                    <option value="Asia/Seoul">KST (Seoul)</option>
                    <option value="Asia/Singapore">SGT (Singapore)</option>
                    <option value="Australia/Sydney">AEDT (Sydney, Melbourne)</option>
                    <option value="Australia/Perth">AWST (Perth)</option>
                    <option value="Pacific/Auckland">NZDT (Auckland)</option>
                </select>
            </div>
            <div class="preference-group">
                <h3>Date Format</h3>
                <label><input type="radio" name="dateFormat" value="MM/DD/YYYY"> MM/DD/YYYY (US)</label>
                <label><input type="radio" name="dateFormat" value="DD/MM/YYYY"> DD/MM/YYYY (UK/EU)</label>
                <label><input type="radio" name="dateFormat" value="YYYY-MM-DD"> YYYY-MM-DD (ISO)</label>
            </div>
            <div class="preference-group">
                <h3>Country</h3>
                <select id="setupCountrySelect">
                    <option value="US">United States</option>
                    <option value="UK">United Kingdom</option>
                    <option value="IE">Ireland</option>
                    <option value="CA">Canada</option>
                    <option value="AU">Australia</option>
                    <option value="DE">Germany</option>
                    <option value="FR">France</option>
                    <option value="IT">Italy</option>
                    <option value="ES">Spain</option>
                    <option value="NL">Netherlands</option>
                    <option value="BE">Belgium</option>
                    <option value="PL">Poland</option>
                    <option value="SE">Sweden</option>
                    <option value="NO">Norway</option>
                    <option value="DK">Denmark</option>
                    <option value="FI">Finland</option>
                    <option value="PT">Portugal</option>
                    <option value="GR">Greece</option>
                    <option value="AT">Austria</option>
                    <option value="CH">Switzerland</option>
                    <option value="JP">Japan</option>
                    <option value="CN">China</option>
                    <option value="IN">India</option>
                    <option value="BR">Brazil</option>
                    <option value="MX">Mexico</option>
                    <option value="ZA">South Africa</option>
                    <option value="NZ">New Zealand</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <button id="setupPreferencesContinueBtn">Continue</button>
        </div>
    </div>
    <div id="setupDepartmentScreen" class="screen">
        <div class="container">
            <h2>Finally, let's select your department</h2>
            <label><input type="radio" name="department" value="Development Department"> Development</label>
            <label><input type="radio" name="department" value="Customer Relations Department"> Customer Relations</label>
            <label><input type="radio" name="department" value="Finance Department"> Finance</label>
            <button id="setupDepartmentContinueBtn">Continue</button>
        </div>
    </div>
    <div id="setupVerifyScreen" class="screen loading-screen">
        <div class="container black-bg">
            <h2>Verifying...</h2>
            <div class="spinner"></div>
            <p class="loading-text">Just setting up your profile</p>
            <p class="loading-text">Creating your unique interface</p>
            <p class="loading-text">Finalising</p>
        </div>
    </div>
    <div id="setupCompleteScreen" class="screen">
        <div class="container">
            <h2>Welcome, <span id="setupWelcomeName"></span>, to your new Staff Portal!</h2>
            <p>Let's take a look around!</p>
            <button id="setupCompleteBtn">Continue</button>
        </div>
    </div>
    <div id="portalWelcomeScreen" class="screen">
        <div class="container">
            <img id="portalWelcomeProfilePic" class="profile-img" src="" alt="Profile" style="display:block;margin:0 auto 1em auto;width:100px;height:100px;border-radius:50%;object-fit:cover;">
            <h2>Welcome back, <span id="portalWelcomeName"></span>!</h2>
            <p>Previous login: <span id="portalLastLogin"></span></p>
            <button id="portalLoginBtn">Log In</button>
        </div>
    </div>
    
    <!-- Sequential Loading Screen -->
    <div id="sequentialLoadingScreen" class="screen">
        <div class="container" style="text-align: center; max-width: 500px;">
            <div class="loading-spinner" style="width: 80px; height: 80px; border: 8px solid #f3f3f3; border-top: 8px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 30px;"></div>
            <h2 style="font-size: 28px; margin-bottom: 15px;">Welcome back, <span id="loadingUserName">User</span>!</h2>
            <p style="font-size: 16px; color: #666; margin-bottom: 40px;">Just one moment whilst we load everything for you.</p>
            
            <div id="loadingSteps" style="text-align: left; max-width: 400px; margin: 0 auto;">
                <div class="loading-step" data-step="discord" style="padding: 12px 20px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; gap: 15px; opacity: 0.3; transition: all 0.3s;">
                    <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; background: #e0e0e0; flex-shrink: 0;"></div>
                    <span style="font-size: 15px; font-weight: 500;">Loading Discord data...</span>
                </div>
                <div class="loading-step" data-step="database" style="padding: 12px 20px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; gap: 15px; opacity: 0.3; transition: all 0.3s;">
                    <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; background: #e0e0e0; flex-shrink: 0;"></div>
                    <span style="font-size: 15px; font-weight: 500;">Loading database data...</span>
                </div>
                <div class="loading-step" data-step="backend" style="padding: 12px 20px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; gap: 15px; opacity: 0.3; transition: all 0.3s;">
                    <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; background: #e0e0e0; flex-shrink: 0;"></div>
                    <span style="font-size: 15px; font-weight: 500;">Loading backend and Cloudflare...</span>
                </div>
                <div class="loading-step" data-step="sentinel" style="padding: 12px 20px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; gap: 15px; opacity: 0.3; transition: all 0.3s;">
                    <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; background: #e0e0e0; flex-shrink: 0;"></div>
                    <span style="font-size: 15px; font-weight: 500;">Loading Sentinel...</span>
                </div>
                <div class="loading-step" data-step="contents" style="padding: 12px 20px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; gap: 15px; opacity: 0.3; transition: all 0.3s;">
                    <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; background: #e0e0e0; flex-shrink: 0;"></div>
                    <span style="font-size: 15px; font-weight: 500;">Loading contents...</span>
                </div>
                <div class="loading-step" data-step="success" style="padding: 12px 20px; margin-bottom: 10px; background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; gap: 15px; opacity: 0.3; transition: all 0.3s;">
                    <div class="step-icon" style="width: 24px; height: 24px; border-radius: 50%; background: #e0e0e0; flex-shrink: 0;"></div>
                    <span style="font-size: 15px; font-weight: 500; color: #4caf50;">Success! ‚úì</span>
                </div>
            </div>
        </div>
    </div>
    
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-step.active {
            opacity: 1 !important;
            background: #e8eaf6 !important;
        }
        
        .loading-step.active .step-icon {
            background: #667eea !important;
            animation: pulse 1s ease-in-out infinite;
        }
        
        .loading-step.completed {
            opacity: 1 !important;
            background: #e8f5e9 !important;
        }
        
        .loading-step.completed .step-icon {
            background: #4caf50 !important;
            animation: none;
            position: relative;
        }
        
        .loading-step.completed .step-icon::after {
            content: '‚úì';
            color: white;
            font-size: 14px;
            font-weight: bold;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
    </style>
    
    <div id="mainMenuScreen" class="screen">
        <div class="container" style="max-width: 350%; margin: 0 auto; padding-left: 0; padding-right: 0;">
            <!-- Enlarged greeting section (full width rectangle) -->
            <div class="user-header-card" style="padding: 30px; margin-bottom: 24px; margin-left: 1; margin-right: 1;">
                <div style="display: flex; align-items: center; gap: 20px;">
                    <img id="mainProfilePic" class="profile-img" src="" alt="Profile" style="width: 80px; height: 80px;">
                    <div class="user-info" style="flex: 1;">
                        <h2 id="greeting" style="font-size: 32px; margin: 0 0 8px 0;"></h2>
                        <p id="lastLogin" style="font-size: 16px; margin: 0 0 0 0; color: #666;"></p>
                    </div>
                    <p id="dateTime" class="datetime-display" style="font-size: 18px; font-weight: 600;"></p>
                </div>
            </div>
            
            <!-- Side-by-side absences and department sections (two squares) -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; width: 100%;">
                <!-- Absences Card -->
                <div class="stat-card" style="padding: 30px;">
                    <h3 style="font-size: 20px; margin-bottom: 24px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        Total Absences
                    </h3>
                    <p id="totalAbsences" style="font-size: 48px; font-weight: 700; margin: 0 0 16px 0; color: #667eea;">0</p>
                    <h3 style="font-size: 18px; margin-bottom: 12px; margin-top: 32px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        Total Absence Days
                    </h3>
                    <p id="totalAbsenceDays" style="font-size: 36px; font-weight: 600; margin: 0; color: #667eea;">0</p>
                </div>
                
                <!-- Department Card -->
                <div class="stat-card" style="padding: 30px; display: flex; flex-direction: column;">
                    <h3 style="font-size: 20px; margin-bottom: 24px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                        </svg>
                        Department
                    </h3>
                    <p id="currentDepartment" style="font-size: 42px; font-weight: 700; margin: 0 0 24px 0; color: #667eea;">Development</p>
                    <p class="hint" style="font-size: 15px; color: #888; margin-bottom: 20px; flex: 1;">Wish to change? Click the button below to go to your profile settings and request a change.</p>
                    <button id="changeDepartmentBtn" style="width: 100%; padding: 14px; font-size: 16px; font-weight: 600;">Change My Department</button>
                </div>
            </div>
            
            <!-- Base Level Row -->
            <div style="margin-top: 24px; width: 100%;">
                <div class="stat-card" style="padding: 30px;">
                    <h3 style="font-size: 20px; margin-bottom: 24px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                            <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
                        </svg>
                        Base Level
                    </h3>
                    <p id="baseLevel" style="font-size: 36px; font-weight: 700; margin: 0; color: #667eea;">Not Set</p>
                </div>
            </div>
        </div>
    </div>
        <div id="myProfileScreen" class="screen">
        <div class="container" style="max-width: 300%; margin: 0 auto;">
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                    <h2 style="margin: 0 0 8px 0; font-size: 28px; font-weight: 600;">Profile Settings</h2>
                    <p style="margin: 0; color: #666; font-size: 15px; line-height: 1.5;">
                        Manage your profile information, theme preferences, and request changes to your account settings. To make a request, click the edit button beside a relevant field and follow further instructions.
                    </p>
                </div>
                
                <div style="flex: 1; background: white; border-radius: 12px; overflow: auto; box-shadow: 0 2px 8px rgba(0,0,0,0.08); padding: 30px;">
                    <div style="max-width: 100%; display: flex; flex-direction: column; gap: 24px;">
                        
                        <!-- Profile Debug/Error Panel -->
                        <div id="profileDebugPanel" style="display: none; padding: 12px 16px; background: #fee; border: 1px solid #fcc; border-radius: 8px; color: #c00;">
                            <strong>‚ö†Ô∏è Profile Loading Issue:</strong>
                            <div id="profileDebug" style="margin-top: 4px; font-size: 14px;"></div>
                            <button id="retryProfileBtn" style="margin-top: 10px; background: #7c3aed; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 500;">üîÑ Retry</button>
                        </div>
                        
                        <!-- Profile Information Section -->
                        <div style="display: flex; flex-direction: column; gap: 16px;">
                            <h3 style="margin: 0; font-size: 18px; font-weight: 600; color: #111827; border-bottom: 2px solid #7c3aed; padding-bottom: 8px;">Profile Information</h3>
                            
                            <div class="profile-info-row" style="display: flex; align-items: center; justify-content: space-between; padding: 14px; background: #f9fafb; border-radius: 8px;">
                                <span style="font-weight: 600; color: #6b7280;">Name:</span>
                                <span id="profileName" style="color: #111827; flex: 1; margin: 0 20px; text-align: right;">Not set</span>
                                <button class="pencil-btn" id="editNameBtn" title="Request Name Change" style="background: #7c3aed; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">‚úé Edit</button>
                            </div>
                            
                            <div class="profile-info-row" style="display: flex; align-items: center; justify-content: space-between; padding: 14px; background: #f9fafb; border-radius: 8px;">
                                <span style="font-weight: 600; color: #6b7280;">Department:</span>
                                <span id="profileDepartment" style="color: #111827; flex: 1; margin: 0 20px; text-align: right;">Not set</span>
                                <button class="pencil-btn" id="editDeptBtn" title="Request Department Change" style="background: #7c3aed; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">‚úé Edit</button>
                            </div>
                            
                            <div class="profile-info-row" style="display: flex; align-items: center; justify-content: space-between; padding: 14px; background: #f9fafb; border-radius: 8px;">
                                <span style="font-weight: 600; color: #6b7280;">Email:</span>
                                <span id="profileEmail" style="color: #111827; flex: 1; margin: 0 20px; text-align: right;">Not set</span>
                                <button class="pencil-btn" id="editEmailBtn" title="Request Email Change" style="background: #7c3aed; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">‚úé Edit</button>
                            </div>
                            
                            <div class="profile-info-row" style="display: flex; align-items: center; justify-content: space-between; padding: 14px; background: #f9fafb; border-radius: 8px;">
                                <span style="font-weight: 600; color: #6b7280;">Country:</span>
                                <select id="profileCountrySelect" style="flex: 1; margin: 0 20px; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white; color: #111827; font-size: 14px; cursor: pointer;">
                                    <option value="">Select Country</option>
                                    <option value="United Kingdom">üá¨üáß United Kingdom</option>
                                    <option value="Ireland">üáÆüá™ Ireland</option>
                                    <option value="United States">üá∫üá∏ United States</option>
                                    <option value="Canada">üá®üá¶ Canada</option>
                                    <option value="Australia">üá¶üá∫ Australia</option>
                                    <option value="Germany">üá©üá™ Germany</option>
                                    <option value="France">üá´üá∑ France</option>
                                    <option value="Spain">üá™üá∏ Spain</option>
                                    <option value="Italy">üáÆüáπ Italy</option>
                                    <option value="Netherlands">üá≥üá± Netherlands</option>
                                    <option value="Belgium">üáßüá™ Belgium</option>
                                    <option value="Poland">üáµüá± Poland</option>
                                    <option value="Sweden">üá∏üá™ Sweden</option>
                                    <option value="Norway">üá≥üá¥ Norway</option>
                                    <option value="Denmark">üá©üá∞ Denmark</option>
                                    <option value="Finland">üá´üáÆ Finland</option>
                                    <option value="Portugal">üáµüáπ Portugal</option>
                                    <option value="Greece">üá¨üá∑ Greece</option>
                                    <option value="Austria">üá¶üáπ Austria</option>
                                    <option value="Switzerland">üá®üá≠ Switzerland</option>
                                    <option value="Japan">üáØüáµ Japan</option>
                                    <option value="China">üá®üá≥ China</option>
                                    <option value="India">üáÆüá≥ India</option>
                                    <option value="Brazil">üáßüá∑ Brazil</option>
                                    <option value="Mexico">üá≤üáΩ Mexico</option>
                                    <option value="South Africa">üáøüá¶ South Africa</option>
                                    <option value="New Zealand">üá≥üáø New Zealand</option>
                                    <option value="Other">üåç Other</option>
                                </select>
                            </div>
                            
                            <div class="profile-info-row" style="display: flex; align-items: center; justify-content: space-between; padding: 14px; background: #f9fafb; border-radius: 8px;">
                                <span style="font-weight: 600; color: #6b7280;">Timezone:</span>
                                <select id="profileTimezoneSelect" style="flex: 1; margin: 0 20px; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white; color: #111827; font-size: 14px; cursor: pointer;">
                                    <option value="">Select Timezone</option>
                                    <option value="UTC">UTC (Coordinated Universal Time)</option>
                                    <option value="Europe/London">GMT/BST (London, Dublin)</option>
                                    <option value="Europe/Paris">CET/CEST (Paris, Madrid, Rome)</option>
                                    <option value="Europe/Berlin">CET/CEST (Berlin, Amsterdam, Brussels)</option>
                                    <option value="Europe/Warsaw">CET/CEST (Warsaw, Prague)</option>
                                    <option value="Europe/Athens">EET/EEST (Athens, Bucharest)</option>
                                    <option value="Europe/Istanbul">TRT (Istanbul)</option>
                                    <option value="Europe/Moscow">MSK (Moscow)</option>
                                    <option value="America/New_York">EST/EDT (New York, Toronto)</option>
                                    <option value="America/Chicago">CST/CDT (Chicago, Mexico City)</option>
                                    <option value="America/Denver">MST/MDT (Denver, Phoenix)</option>
                                    <option value="America/Los_Angeles">PST/PDT (Los Angeles, Vancouver)</option>
                                    <option value="America/Anchorage">AKST/AKDT (Alaska)</option>
                                    <option value="Pacific/Honolulu">HST (Hawaii)</option>
                                    <option value="America/Sao_Paulo">BRT (S√£o Paulo, Rio)</option>
                                    <option value="Asia/Dubai">GST (Dubai, Abu Dhabi)</option>
                                    <option value="Asia/Kolkata">IST (India)</option>
                                    <option value="Asia/Shanghai">CST (Beijing, Shanghai)</option>
                                    <option value="Asia/Tokyo">JST (Tokyo)</option>
                                    <option value="Asia/Seoul">KST (Seoul)</option>
                                    <option value="Asia/Singapore">SGT (Singapore)</option>
                                    <option value="Australia/Sydney">AEDT (Sydney, Melbourne)</option>
                                    <option value="Australia/Perth">AWST (Perth)</option>
                                    <option value="Pacific/Auckland">NZDT (Auckland)</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Theme Section -->
                        <div style="display: flex; flex-direction: column; gap: 16px;">
                            <h3 style="margin: 0; font-size: 18px; font-weight: 600; color: #111827; border-bottom: 2px solid #7c3aed; padding-bottom: 8px;">Appearance</h3>
                            
                            <div class="profile-info-row" style="display: flex; align-items: center; justify-content: space-between; padding: 14px; background: #f9fafb; border-radius: 8px;">
                                <span style="font-weight: 600; color: #6b7280;">Theme:</span>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="modeToggle">
                                        <span class="slider">üåô</span>
                                    </label>
                                    <span id="themeText" style="color: #6b7280;">Light Mode</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Actions Section -->
                        <div style="padding-top: 8px;">
                            <button id="resetProfileBtn" style="width: 100%; background: #ef4444; color: white; border: none; padding: 14px; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.2s ease;" onmouseover="this.style.background='#dc2626'" onmouseout="this.style.background='#ef4444'">Reset Profile</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
                    </div>
                </div>
                
                <div id="authDebug" style="margin-top:8px;color:#1976d2;font-size:0.95em;"></div>
            </div>
        </div>
    </div>
    <div id="myRolesScreen" class="screen">
        <div class="container">
            <h2><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>My Roles</h2>
            <ul id="rolesList"></ul>
        </div>
    </div>
    <div id="absencesScreen" class="screen">
        <div style="padding: 40px 0 30px 0; height: 100%; display: flex; flex-direction: column; align-items: center;">
            <div style="width: 190%; max-width: 190%; height: 100%; display: flex; flex-direction: column;">
                <div style="margin-bottom: 20px; padding-left: 20px;">
                    <h2 style="margin: 0 0 10px 0;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>Absences</h2>
                    <p style="margin: 0 0 15px 0; color: #666; font-size: 14px;">View a list of your absences either Pending, Approved, Rejected or Archived! Please do not delete archived absences.</p>
                    <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <span style="width: 10px; height: 10px; border-radius: 50%; background: #4CAF50; display: inline-block;"></span>
                            <span style="font-size: 13px; color: #666;">Approved</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <span style="width: 10px; height: 10px; border-radius: 50%; background: #f44336; display: inline-block;"></span>
                            <span style="font-size: 13px; color: #666;">Rejected</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <span style="width: 10px; height: 10px; border-radius: 50%; background: #FF9800; display: inline-block;"></span>
                            <span style="font-size: 13px; color: #666;">Pending</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <span style="width: 10px; height: 10px; border-radius: 50%; background: #9e9e9e; display: inline-block;"></span>
                            <span style="font-size: 13px; color: #666;">Archived</span>
                        </div>
                    </div>
                    <div class="absence-tabs">
                        <button class="absence-tab-btn active" data-tab="approved"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><polyline points="20 6 9 17 4 12"></polyline></svg>Approved</button>
                        <button class="absence-tab-btn" data-tab="rejected"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>Rejected</button>
                        <button class="absence-tab-btn" data-tab="pending"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>Pending</button>
                        <button class="absence-tab-btn" data-tab="archived"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><polyline points="21 8 21 21 3 21 3 8"></polyline><rect x="1" y="3" width="22" height="5"></rect><line x1="10" y1="12" x2="14" y2="12"></line></svg>Archived</button>
                        <div class="absence-tab-slider"></div>
                    </div>
                </div>
                <div style="flex: 1; background: white; border-radius: 12px; overflow: auto; box-shadow: 0 2px 8px rgba(0,0,0,0.08); position: relative;">
                    <div class="absence-content" style="padding: 20px;">
                        <div id="approvedFolder" class="absence-folder active">
                            <ul id="approvedAbsences" style="list-style: none; padding: 0; margin: 0;"></ul>
                        </div>
                        <div id="rejectedFolder" class="absence-folder">
                            <ul id="rejectedAbsences" style="list-style: none; padding: 0; margin: 0;"></ul>
                        </div>
                        <div id="pendingFolder" class="absence-folder">
                            <ul id="pendingAbsences" style="list-style: none; padding: 0; margin: 0;"></ul>
                        </div>
                        <div id="archivedFolder" class="absence-folder">
                            <ul id="archivedAbsences" style="list-style: none; padding: 0; margin: 0;"></ul>
                        </div>
                    </div>
                    <button id="requestAbsenceBtn" style="position: absolute; bottom: 20px; left: 20px; background: #1976d2; color: white; border: none; padding: 12px 24px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; box-shadow: 0 2px 8px rgba(25, 118, 210, 0.3); transition: all 0.2s ease; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(25, 118, 210, 0.4)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(25, 118, 210, 0.3)'">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        Request Absence
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div id="payslipsScreen" class="screen">
        <div style="padding: 40px 0 30px 0; height: 100%; display: flex; flex-direction: column; align-items: center;">
            <div style="width: 250%; max-width: 250%; height: 100%; display: flex; flex-direction: column;">
                <div style="margin-bottom: 20px; padding-left: 20px;">
                    <h2 style="margin: 0 0 10px 0;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>Payslips</h2>
                    <p style="color: #666; font-size: 14px; margin: 0;">View payslips that have been assigned to you here. Click into them to view more details</p>
                </div>
                <div id="payslipsContent" style="width: 100%; flex: 1; min-height: 600px; background: white; border-radius: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.08); overflow-y: auto; padding: 0;"></div>
            </div>
        </div>
    </div>
    <div id="disciplinariesScreen" class="screen">
        <div style="padding: 40px 0 30px 0; height: 100%; display: flex; flex-direction: column; align-items: center;">
            <div style="width: 170%; max-width: 170%; height: 100%; display: flex; flex-direction: column;">
                <div style="margin-bottom: 20px; padding-left: 20px;">
                    <h2 style="margin: 0 0 10px 0;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>Disciplinaries & Reports</h2>
                    <p style="color: #666; font-size: 14px; margin: 0 0 15px 0;">View your strikes, disciplinaries, and employee reports here. To appeal, contact your Department Head or the OP who assigned them.</p>
                    
                    <!-- Staff Points Speedometer -->
                    <div style="display: flex; align-items: center; gap: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 30px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4); width: 100%; max-width: 100%; flex-wrap: wrap;">
                        <div style="position: relative; width: 120px; height: 80px;">
                            <svg width="120" height="80" viewBox="0 0 120 80" style="overflow: visible;">
                                <!-- Background arc -->
                                <path d="M 10 70 A 50 50 0 0 1 110 70" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="12" stroke-linecap="round"/>
                                <!-- Colored segments -->
                                <path d="M 10 70 A 50 50 0 0 1 35 32" fill="none" stroke="#ef4444" stroke-width="12" stroke-linecap="round"/>
                                <path d="M 35 32 A 50 50 0 0 1 60 20" fill="none" stroke="#f59e0b" stroke-width="12" stroke-linecap="round"/>
                                <path d="M 60 20 A 50 50 0 0 1 85 32" fill="none" stroke="#10b981" stroke-width="12" stroke-linecap="round"/>
                                <!-- Needle -->
                                <g id="staffPointsNeedle" transform="rotate(0 60 70)" style="transition: transform 0.5s ease-out;">
                                    <line x1="60" y1="70" x2="60" y2="30" stroke="white" stroke-width="3" stroke-linecap="round"/>
                                    <circle cx="60" cy="70" r="6" fill="white"/>
                                </g>
                                <!-- Center point labels -->
                                <text x="10" y="78" fill="white" font-size="10" font-weight="bold">-10</text>
                                <text x="52" y="15" fill="white" font-size="10" font-weight="bold">0</text>
                                <text x="105" y="78" fill="white" font-size="10" font-weight="bold">+10</text>
                            </svg>
                        </div>
                        <div>
                            <div style="font-weight: 600; font-size: 14px; opacity: 0.9; margin-bottom: 4px;">Staff Points</div>
                            <div id="staffPointsCounter" style="font-weight: 700; font-size: 32px; line-height: 1;">0</div>
                        </div>
                    </div>
                    
                    <!-- Tabs for Disciplinaries and Reports -->
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button id="disciplinariesTabBtn" class="section-tab-btn active" data-section="disciplinaries" style="padding: 10px 20px; border: none; background: #7c3aed; color: white; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path></svg>
                            Disciplinaries
                        </button>
                        <button id="reportsTabBtn" class="section-tab-btn" data-section="reports" style="padding: 10px 20px; border: none; background: #e0e0e0; color: #666; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                            My Reports
                        </button>
                    </div>
                </div>
                
                <!-- Disciplinaries Section -->
                <div id="disciplinariesSection" class="content-section active" style="width: 100%; flex: 1; min-height: 600px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow-y: auto;">
                    <div id="disciplinariesContent" style="height: 100%;">
                        <div id="disciplinariesList" class="disciplinaries-list">
                            <!-- Dynamic content will be inserted here -->
                        </div>
                        <div id="disciplinariesEmpty" class="empty-state hidden">
                            <p>No disciplinaries found.</p>
                        </div>
                        <div id="disciplinariesLoading" class="loading-state">
                            <p>Loading disciplinaries...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Reports Section -->
                <div id="reportsSection" class="content-section" style="display: none; width: 100%; flex: 1; min-height: 600px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow-y: auto;">
                    <div id="reportsContent" style="height: 100%; padding: 20px;">
                        <div id="reportsList" class="reports-list">
                            <!-- Dynamic content will be inserted here -->
                        </div>
                        <div id="reportsEmpty" class="empty-state hidden">
                            <p>No reports found.</p>
                        </div>
                        <div id="reportsLoading" class="loading-state" style="display: none;">
                            <p>Loading reports...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="requestsScreen" class="screen">
        <div style="padding: 40px 0 30px 0; height: 100%; display: flex; flex-direction: column; align-items: center;">
            <div style="width: 250%; max-width: 250%; height: 150%; display: flex; flex-direction: column;">
                <div style="margin-bottom: 20px; padding-left: 40px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2 style="margin: 0 0 10px 0;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>Requests</h2>
                        <p style="color: #666; font-size: 14px; margin: 0;">Submit and track your requests here. Requests can be for resignations, disputes, payments, bug reports, or suggestions.</p>
                    </div>
                    <button id="submitRequestBtn" class="action-btn" style="padding: 12px 24px; border-radius: 8px; background: #667eea; color: white; border: none; font-weight: 600; cursor: pointer; white-space: nowrap;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        Submit Request
                    </button>
                </div>
                <div style="width: 100%; flex: 1; min-height: 600px; background: white; border-radius: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.08); overflow-y: auto;">
                    <div id="requestsContent" style="height: 100%; padding: 20px;">
                        <div id="requestsList" class="requests-list">
                            <!-- Dynamic content will be inserted here -->
                        </div>
                        <div id="requestsEmpty" class="empty-state hidden">
                            <p>No requests found. Click "Submit Request" to create one.</p>
                        </div>
                        <div id="requestsLoading" class="loading-state">
                            <p>Loading requests...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="timeclockScreen" class="screen">
        <div style="padding: 40px 0 30px 0; height: 100%; display: flex; flex-direction: column; align-items: center;">
            <div style="width: 100%; max-width: 1200px; height: 100%; display: flex; flex-direction: column;">
                <h2 style="margin: 0 0 30px 0; padding-left: 20px;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>Timeclock</h2>
                <div style="flex: 1; background: white; border-radius: 16px; padding: 40px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: flex; flex-direction: column; overflow-y: auto;">
                    <div id="clockDisplay" style="text-align: center; font-size: 48px; font-weight: bold; margin-bottom: 30px; padding: 30px; background: #f5f5f5; border-radius: 12px;"></div>
                    <div style="display: flex; gap: 20px; justify-content: center; margin-bottom: 30px;">
                        <button id="clockInBtn" style="flex: 1; max-width: 300px; padding: 20px 50px; font-size: 18px; font-weight: 600; border-radius: 12px;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="10 17 15 12 10 7"></polyline><line x1="15" y1="12" x2="3" y2="12"></line></svg>Clock In</button>
                        <button id="clockOutBtn" class="hidden" style="flex: 1; max-width: 300px; padding: 20px 50px; font-size: 18px; font-weight: 600; border-radius: 12px;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>Clock Out</button>
                    </div>
                    <div id="sessionInfo" class="session-item hidden" style="background: #e3f2fd; padding: 20px; border-radius: 12px; margin-bottom: 30px;"></div>
                    <h3 style="margin: 20px 0 20px 0; font-size: 24px;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><polyline points="1 4 1 10 7 10"></polyline><polyline points="23 20 23 14 17 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path></svg>Previous Sessions</h3>
                    <div id="previousSessions" class="session-list" style="flex: 1; overflow-y: auto;"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="mailScreen" class="screen">
        <div style="padding: 40px 0 30px 0; height: 100%; display: flex; flex-direction: column; align-items: center;">
            <div style="width: 220%; max-width: 220%; height: 100%; display: flex; flex-direction: column;">
                <div style="margin-bottom: 20px; padding-left: 20px;">
                    <h2 style="margin: 0 0 10px 0;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>Mail</h2>
                    <p style="margin: 0 0 15px 0; color: #666; font-size: 14px;">Compose your mail, view your drafts, check your inbox, and stay connected with your colleagues!</p>
                    <button id="composeMailBtn" style="background: #1976d2; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; margin-bottom: 15px; box-shadow: 0 2px 6px rgba(25, 118, 210, 0.3); transition: all 0.2s ease;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3h18v18H3zM3 3l9 9m9-9l-9 9"></path></svg>
                        Compose Mail
                    </button>
                    <div class="mail-tabs">
                        <button class="tab-btn active" data-tab="inbox"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><polyline points="22 12 16 12 14 15 10 15 8 12 2 12"></polyline><path d="M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"></path></svg>Inbox</button>
                        <button class="tab-btn" data-tab="sent"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>Sent</button>
                        <button class="tab-btn" data-tab="drafts"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>Drafts</button>
                        <div class="tab-slider"></div>
                    </div>
                </div>
                <div style="flex: 1; background: white; border-radius: 12px; overflow: auto; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                    <div class="mail-content" style="padding: 20px;">
                        <div id="inboxFolder" class="mail-folder active">
                            <ul id="inboxContent" style="list-style: none; padding: 0; margin: 0;"></ul>
                        </div>
                        <div id="sentFolder" class="mail-folder">
                            <ul id="sentContent" style="list-style: none; padding: 0; margin: 0;"></ul>
                        </div>
                        <div id="draftsFolder" class="mail-folder">
                            <ul id="draftsContent" style="list-style: none; padding: 0; margin: 0;"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ClickUp Screen -->
    <div id="clickupScreen" class="screen">
        <div class="container" style="max-width: 250%; margin: 0 auto;">
            <div style="display: flex; flex-direction: column; gap: 20px; height: 100%;">
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                    <h2 style="margin: 0 0 8px 0; font-size: 28px; font-weight: 600;">ClickUp Tasks</h2>
                    <p style="margin: 0; color: #666; font-size: 15px; line-height: 1.5;">
                        Manage your ClickUp tasks directly from the portal. Connect your account to view and update tasks.
                    </p>
                </div>
                
                <div id="clickupConnectionSection" style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                    <div id="clickupDisconnected">
                        <h3 style="margin: 0 0 12px 0; font-size: 18px; font-weight: 600;">Connect Your ClickUp Account</h3>
                        <p style="margin: 0 0 16px 0; color: #666; font-size: 14px;">
                            Enter your ClickUp Personal API Token to get started. You can find this in your ClickUp account settings under "Apps".
                        </p>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <textarea id="clickupTokenInput" placeholder="Paste your Personal API Token here..." style="width: 100%; min-height: 80px; padding: 12px 16px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; font-family: 'Inter', sans-serif; resize: vertical;"></textarea>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <p style="margin: 0; font-size: 12px; color: #999;">
                                    <a href="https://app.clickup.com/settings/apps" target="_blank" style="color: #7c3aed;">Get your API token here</a>
                                </p>
                                <button id="clickupConnectBtn" style="padding: 12px 24px; background: #7c3aed; color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; white-space: nowrap;">
                                    Connect
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="clickupConnected" style="display: none;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin: 0 0 4px 0; font-size: 18px; font-weight: 600;">‚úì Connected to ClickUp</h3>
                                <p style="margin: 0; color: #666; font-size: 14px;" id="clickupWorkspaceName">Loading workspace...</p>
                            </div>
                            <button id="clickupDisconnectBtn" style="padding: 10px 20px; background: #ef4444; color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer;">
                                Disconnect
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="clickupTasksSection" style="display: none; flex: 1; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); display: flex; flex-direction: column;">
                    <div style="padding: 16px 20px; border-bottom: 1px solid #eee;">
                        <div class="clickup-tabs" style="display: flex; gap: 8px;">
                            <button class="clickup-tab-btn active" data-status="all" style="padding: 8px 16px; border: none; background: #f3f4f6; color: #374151; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                                All Tasks
                            </button>
                            <button class="clickup-tab-btn" data-status="to do" style="padding: 8px 16px; border: none; background: transparent; color: #6b7280; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                                To Do
                            </button>
                            <button class="clickup-tab-btn" data-status="in progress" style="padding: 8px 16px; border: none; background: transparent; color: #6b7280; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                                In Progress
                            </button>
                            <button class="clickup-tab-btn" data-status="complete" style="padding: 8px 16px; border: none; background: transparent; color: #6b7280; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                                Complete
                            </button>
                            <button id="clickupRefreshBtn" style="margin-left: auto; padding: 8px 16px; border: none; background: transparent; color: #7c3aed; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                                üîÑ Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div style="flex: 1; overflow: auto; padding: 20px;">
                        <div id="clickupTasksContainer">
                            <!-- Tasks will be rendered here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Calendar Screen -->
    <div id="calendarScreen" class="screen">
        <div style="padding: 40px 0 30px 0; height: 100%; display: flex; flex-direction: column; align-items: center;">
            <div style="width: 100%; max-width: 1200px; height: 100%; display: flex; flex-direction: column;">
                <div style="margin-bottom: 20px;">
                    <h2 style="margin: 0 0 10px 0;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 8px;"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>Calendar</h2>
                    <p style="color: #666; font-size: 14px; margin: 0;">View all scheduled events and activities for your team</p>
                </div>
                <div style="flex: 1; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: flex; flex-direction: column;">
                    <!-- Calendar header -->
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 20px; border-bottom: 1px solid #e5e7eb;">
                        <button id="calendarPrevMonth" style="padding: 8px 16px; border: none; background: #f3f4f6; border-radius: 6px; cursor: pointer; font-weight: 600;">‚Üê Previous</button>
                        <h3 id="calendarMonthYear" style="margin: 0; font-size: 18px; font-weight: 600;"></h3>
                        <button id="calendarNextMonth" style="padding: 8px 16px; border: none; background: #f3f4f6; border-radius: 6px; cursor: pointer; font-weight: 600;">Next ‚Üí</button>
                    </div>
                    <!-- Calendar grid -->
                    <div style="flex: 1; overflow-y: auto; padding: 20px;">
                        <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px;">
                            <!-- Day headers -->
                            <div style="text-align: center; font-weight: 600; color: #6b7280; padding: 10px; font-size: 12px;">MON</div>
                            <div style="text-align: center; font-weight: 600; color: #6b7280; padding: 10px; font-size: 12px;">TUE</div>
                            <div style="text-align: center; font-weight: 600; color: #6b7280; padding: 10px; font-size: 12px;">WED</div>
                            <div style="text-align: center; font-weight: 600; color: #6b7280; padding: 10px; font-size: 12px;">THU</div>
                            <div style="text-align: center; font-weight: 600; color: #6b7280; padding: 10px; font-size: 12px;">FRI</div>
                            <div style="text-align: center; font-weight: 600; color: #6b7280; padding: 10px; font-size: 12px;">SAT</div>
                            <div style="text-align: center; font-weight: 600; color: #6b7280; padding: 10px; font-size: 12px;">SUN</div>
                            <!-- Calendar days -->
                            <div id="calendarDays" style="grid-column: 1 / -1; display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Calendar Event Detail Modal -->
    <div id="calendarEventModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="eventDate" style="margin: 0 0 10px 0;"></h2>
            <div id="eventList" style="max-height: 400px; overflow-y: auto;"></div>
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button id="addEventBtn" style="flex: 1; padding: 10px 20px; background: #7c3aed; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">+ Add Event</button>
            </div>
        </div>
    </div>
    
    <div id="suspendedScreen" class="screen">
        <div class="container suspended-portal">
            <h2>üö´ Portal Suspended</h2>
            <div class="suspended-message">
                <p>Your portal is temporarily suspended.</p>
                <p>Please contact <strong>Marcus Ray</strong> for more details.</p>
            </div>
            <div class="suspended-contact">
                <p>üìß Contact: <a href="mailto:marcus@cirkledevelopment.co.uk">marcus@cirkledevelopment.co.uk</a></p>
                <p>üí¨ Discord: Marcus Ray</p>
            </div>
        </div>
    </div>
    <div id="goodbyeScreen" class="screen">
        <div class="container">
            <h2>Goodbye, <span id="goodbyeName"></span></h2>
        </div>
    </div>
    <div id="mailDeliveryAnimation" class="mail-delivery-animation hidden"></div>

    <footer>¬© Cirkle Development 2024 | Portal V3</footer>

    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="script.js?v=2.0.2"></script>
    <script>
        // Force service worker update on every page load
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(registrations => {
                registrations.forEach(reg => reg.update());
            });
        }
    </script>
</body>
</html>